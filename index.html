<!DOCTYPE html>
<html>
<head>
    <title>KV Connection è¯»å†™ç¤ºä¾‹</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Connection å˜é‡è¯»å†™</h1>
    
    <!-- å†™å…¥è¡¨å• -->
    <section>
        <h2>å†™å…¥ Connection</h2>
        <form id="writeForm">
            <label for="connectionValue">Connection å€¼:</label>
            <input type="text" id="connectionValue" name="value" 
                   placeholder="è¾“å…¥ connection å€¼" required>
            <button type="submit">ä¿å­˜</button>
        </form>
        <p id="writeResult"></p>
    </section>
    
    <!-- è¯»å–éƒ¨åˆ† -->
    <section>
        <h2>è¯»å– Connection</h2>
        <button id="readBtn">è¯»å–å½“å‰å€¼</button>
        <p id="readResult">ç‚¹å‡»æŒ‰é’®è¯»å–</p>
    </section>
    
    <script>
        // å†™å…¥å¤„ç†
        document.getElementById('writeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const value = document.getElementById('connectionValue').value;
            const resultEl = document.getElementById('writeResult');
            
            try {
                const response = await fetch('/api/write', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ value })
                });
                
                const data = await response.json();
                resultEl.textContent = data.success 
                    ? `âœ… ä¿å­˜æˆåŠŸ: ${data.value}`
                    : `âŒ ä¿å­˜å¤±è´¥: ${data.error}`;
                resultEl.style.color = data.success ? 'green' : 'red';
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                document.getElementById('connectionValue').value = '';
            } catch (error) {
                resultEl.textContent = `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`;
                resultEl.style.color = 'red';
            }
        });
        
        // è¯»å–å¤„ç†
        document.getElementById('readBtn').addEventListener('click', async () => {
            const resultEl = document.getElementById('readResult');
            
            try {
                const response = await fetch('/api/read');
                const data = await response.json();
                
                if (data.success) {
                    resultEl.textContent = `ğŸ“– å½“å‰ connection å€¼: ${data.value || 'ï¼ˆç©ºï¼‰'}`;
                    resultEl.style.color = 'blue';
                } else {
                    resultEl.textContent = `âŒ è¯»å–å¤±è´¥: ${data.error}`;
                    resultEl.style.color = 'red';
                }
            } catch (error) {
                resultEl.textContent = `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`;
                resultEl.style.color = 'red';
            }
        });
    </script>
</body>
</html>